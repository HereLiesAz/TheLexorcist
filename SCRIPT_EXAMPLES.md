# Scripting in The Lexorcist: The `lex` Object

Welcome to the advanced scripting engine for The Lexorcist! You can automate tasks and create custom UI elements using Javascript. The primary interface for all advanced functionality is the global `lex` object.

The `lex` object provides access to two powerful sub-systems:
*   `lex.ai`: Interface with a powerful generative AI model (Google's Gemini).
*   `lex.ui`: A toolkit for creating and managing dynamic UI elements, such as custom menu items and new screens.

This document provides two examples to get you started.

---

## 1. Simple Tutorial: "Hello, Dynamic Screens!"

This script demonstrates the most basic use of the `lex.ui` object. It creates a new, clickable menu item in the main navigation rail. When you click this item, it opens a brand new screen that is completely defined by a JSON schema within the script.

### What it Does:
1.  Adds a menu item with the label "My Screen".
2.  When clicked, opens a new screen with a title and a simple text message.
3.  The new screen also contains a button that, when clicked, shows a temporary "toast" message at the bottom of the screen.

### The Script:
```javascript
// This is the core of the Scriptable Screens feature.
// We define a screen's layout and content using a JSON string.
// This string is passed as part of the click action for a menu item.
const myScreenSchema = {
  // The 'title' property will be displayed in the app's top bar.
  title: "Hello World",
  // The 'elements' array defines the content of the screen, rendered top-to-bottom.
  elements: [
    {
      type: "text",
      properties: {
        text: "Welcome to your first scripted screen!",
        size: 20
      }
    },
    {
      type: "spacer",
      properties: {
        height: 16
      }
    },
    {
      type: "button",
      properties: {
        label: "Say Hello",
        // The 'onClickAction' defines what happens when the button is pressed.
        // The 'show_toast:' prefix is a special command handled by the app.
        onClickAction: "show_toast:Hello from a scripted button!"
      }
    }
  ]
};

// Use the lex.ui object to add or update a menu item.
// This function takes an ID, a label, visibility, and a click action.
lex.ui.addOrUpdate(
  "my_first_screen_button", // A unique ID for this menu item.
  "My Screen",              // The text that will appear in the navigation rail.
  true,                     // 'true' to make the item visible.
  // This is the action performed on click. We use a special prefix
  // 'scripted_screen/' followed by our JSON schema. The app knows
  // how to parse this and open our dynamic screen.
  "scripted_screen/" + JSON.stringify(myScreenSchema)
);
```

---

## 2. Advanced Tutorial: AI-Powered In-App Guide

This script demonstrates the true power of combining the AI and UI APIs. It creates a "Tutorial & Tip" menu item that opens a custom screen. This screen not only provides a helpful guide to the app but also features a "Tip of the Day" that is freshly generated by the AI every time the script is run.

### What it Does:
1.  Calls the `lex.ai.generateContent()` function to get a random productivity tip.
2.  Dynamically constructs a JSON schema for a new screen.
3.  Injects the AI-generated tip directly into the content of the screen.
4.  The screen itself serves as a mini-tutorial, explaining the app's main features.
5.  Adds a menu item that, when clicked, displays this dynamic, AI-powered tutorial screen.

### The Script:
```javascript
// Use the AI API to generate a piece of dynamic content.
// The call is synchronous from the script's perspective.
// The app handles the underlying network request and returns the text.
const tipPrompt = "In one sentence, give me a useful and uncommon productivity tip for legal professionals.";
const aiGeneratedTip = lex.ai.generateContent(tipPrompt);

// Now, we'll build the JSON schema for our tutorial screen.
const tutorialSchema = {
  title: "App Tutorial",
  elements: [
    {
      type: "text",
      properties: {
        text: "Welcome to The Lexorcist!",
        size: 24
      }
    },
    {
      type: "text",
      properties: {
        text: "This app helps you organize, analyze, and build your case narrative.",
        size: 16
      }
    },
    { type: "spacer", properties: { height: 24 } },
    {
      type: "text",
      properties: {
        text: "AI Tip of the Day:",
        size: 20
      }
    },
    {
      type: "text",
      properties: {
        // Here, we embed the content we received from the AI.
        // Every time the script runs, this content will be different.
        text: aiGeneratedTip,
        size: 16
      }
    },
    { type: "spacer", properties: { height: 24 } },
    {
      type: "text",
      properties: {
        text: "Use the navigation rail on the left to manage Cases, Evidence, and more.",
        size: 16
      }
    }
  ]
};

// Finally, create the menu item that will open our AI-powered screen.
lex.ui.addOrUpdate(
  "ai_tutorial_screen_button",
  "Tutorial & Tip",
  true,
  "scripted_screen/" + JSON.stringify(tutorialSchema)
);
```
